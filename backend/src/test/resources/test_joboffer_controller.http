### =========================================================================
### 1. AUTHENTIFICATION
### =========================================================================

# @name adminLogin
POST http://localhost:8080/api/auth/login
Content-Type: application/json

{
  "username": "admin",
  "password": "admin"
}

> {% client.global.set("admin_token", response.body.accessToken); %}

###

# @name rhLogin
POST http://localhost:8080/api/auth/login
Content-Type: application/json

{
  "username": "rh_test",
  "password": "123456"
}

> {% client.global.set("rh_token", response.body.accessToken); %}

### =========================================================================
### 2. CYCLE DE VIE DE L'OFFRE (SPEC 2.A)
### =========================================================================

### A. Création d'une demande de poste (DRAFT)
# Un ADMIN ou un Employé avec demandeurDePoste=true peut créer.
# @name createOffer
POST http://localhost:8080/api/joboffers
Authorization: Bearer {{admin_token}}
Content-Type: application/json

{
  "title": "Ingénieur Cloud Senior",
  "description": "Nous recherchons un expert pour piloter l'infrastructure AWS.",
  "department": "IT",
  "skillsRequired": ["AWS", "Terraform", "Kubernetes"]
}

> {% client.global.set("new_offer_id", response.body.id); %}

###

### B. Soumission pour validation (Passage en PENDING)
# Le créateur change le statut pour informer les RH.
PATCH http://localhost:8080/api/joboffers/{{new_offer_id}}/status?status=PENDING
Authorization: Bearer {{admin_token}}

###

### C. Validation et Publication par le RH (OPEN)
# Spec 2.A & 4.A : Le RH enrichit l'offre (Salaire, Télétravail) pour la rendre publique.
PATCH http://localhost:8080/api/joboffers/{{new_offer_id}}/publish?salary=75000&remoteDays=3
Authorization: Bearer {{rh_token}}

###

### D. Vérification de la visibilité publique
# Spec 2.A : Seules les offres OPEN doivent apparaître ici.
GET http://localhost:8080/api/joboffers

### =========================================================================
### 3. RECHERCHE ET CONSULTATION
### =========================================================================

### Recherche par mots-clés (Spec 2.A)
GET http://localhost:8080/api/joboffers/search?keyword=Cloud

###

### Consultation Back-Office (Privilèges Spec 4.A)
# Retourne TOUTES les offres, y compris DRAFT et PENDING (Réservé RH/ADMIN).
GET http://localhost:8080/api/joboffers/privilege
Authorization: Bearer {{rh_token}}

### =========================================================================
### 4. CLÔTURE DE L'OFFRE (SPEC 2.B)
### =========================================================================

### Clôture administrative
PATCH http://localhost:8080/api/joboffers/{{new_offer_id}}/close
Authorization: Bearer {{rh_token}}