### =========================================================================
### 1. AUTHENTICATION (RECUPERATION DES TOKENS)
### =========================================================================

# @name adminLogin
POST http://localhost:8080/api/auth/login
Content-Type: application/json

{
  "username": "bob.admin",
  "password": "password123"
}

> {% client.global.set("admin_token", response.body.accessToken); %}

###

# @name rhLogin
POST http://localhost:8080/api/auth/login
Content-Type: application/json

{
  "username": "alice.rh",
  "password": "password123"
}

> {% client.global.set("rh_token", response.body.accessToken); %}

### =========================================================================
### 2. TESTS USER CONTROLLER
### =========================================================================

### Spec 1 & 6 : Liste technique des utilisateurs (Réservé ADMIN)
# Devrait retourner 200 OK
GET http://localhost:8080/api/users
Authorization: Bearer {{admin_token}}

###

### Test de sécurité : Liste des utilisateurs par un RH
# Devrait retourner 403 Forbidden (car seul ADMIN a ROLE_ADMIN)
GET http://localhost:8080/api/users
Authorization: Bearer {{rh_token}}

###

### Spec 3.A : Vérification RGPD (Consentement < 2 ans)
# Remplacez {id} par l'ID d'un utilisateur existant (ex: 1 ou 2)
GET http://localhost:8080/api/users/1/rgpd-check
Authorization: Bearer {{admin_token}}

###

### Spec 5 : Assignation d'un référent (Succès recrutement)
# Simule le lien hiérarchique entre un candidat (ID: 3) et un employé (ID: 2)
# Autorisé pour RH ou ADMIN
PATCH http://localhost:8080/api/users/1/assign-referent/3
Authorization: Bearer {{rh_token}}

### =========================================================================
### 3. TESTS EMPLOYE CONTROLLER
### =========================================================================

### Spec 1 & 4.A : Liste du personnel RH
GET http://localhost:8080/api/employes/rh
Authorization: Bearer {{admin_token}}

###

### Spec 1 : Liste des "Demandeurs de poste" (Standard/Employés)
GET http://localhost:8080/api/employes/demandeurs
Authorization: Bearer {{admin_token}}

###

### Spec 5 : Voir mes recrues (Lien hiérarchique)
# L'employé (ID: 2) regarde qui il a recruté
GET http://localhost:8080/api/employes/3/recrues
Authorization: Bearer {{rh_token}}